<h1 class="text-2xl font-semibold mb-4">Logs</h1>
<div class="relative overflow-x-auto shadow-md sm:rounded-lg">
  <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
      <tr>
        <th scope="col" class="px-6 py-3">Time</th>
        <th scope="col" class="px-6 py-3">Level</th>
        <th scope="col" class="px-6 py-3">Message</th>
        <th scope="col" class="px-6 py-3">Details</th>
      </tr>
    </thead>
    <tbody>
      <% if (!logs || logs.length === 0) { %>
        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
          <td class="px-6 py-4" colspan="4">No log entries yet.</td>
        </tr>
      <% } else { %>
        <% logs.forEach((entry) => { %>
          <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
            <td class="px-6 py-4"><%= new Date(entry.time).toLocaleString() %></td>
            <td class="px-6 py-4">
              <span class="px-2 py-1 rounded text-xs <%= entry.level === 'error' ? 'bg-red-100 text-red-800' : entry.level === 'success' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800' %>"><%= entry.level %></span>
            </td>
            <td class="px-6 py-4"><%= entry.message %></td>
            <td class="px-6 py-4">
              <% if (entry.meta && entry.meta.counts) { %>
                <div id="accordion-<%= entry.time %>" data-accordion="collapse" class="w-full">
                  <h2 id="accordion-heading-<%= entry.time %>">
                    <button type="button" class="flex items-center justify-between w-full p-2 font-medium rtl:text-right text-gray-500 border border-gray-200 rounded-t-xl focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#accordion-body-<%= entry.time %>" aria-expanded="false" aria-controls="accordion-body-<%= entry.time %>">
                      <span>Counts</span>
                      <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                      </svg>
                    </button>
                  </h2>
                  <div id="accordion-body-<%= entry.time %>" class="hidden" aria-labelledby="accordion-heading-<%= entry.time %>">
                    <div class="p-3 border border-gray-200 dark:border-gray-700">
                      <ul class="list-disc ml-5">
                        <% Object.entries(entry.meta.counts).forEach(([k,v]) => { %>
                          <li><strong class="capitalize"><%= k %>:</strong> <%= v %></li>
                        <% }) %>
                      </ul>
                    </div>
                  </div>
                </div>
              <% } else if (entry.meta && entry.meta.error) { %>
                <span class="text-red-700"><%= entry.meta.error %></span>
              <% } else { %>
                <span class="text-gray-400">â€”</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      <% } %>
    </tbody>
  </table>
</div>
